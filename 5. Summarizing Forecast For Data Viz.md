The combined historical and forecast dataset is approximately 20 million lines. PowerBI will take 20 minutes to apply an update to the core dataset. As a result, I summarize the data using the following queries:  

```

DROP TABLE IF EXISTS [summary_pres];


CREATE TABLE [summary_pres] (
	   [yr]					INT
	  ,[mnth]				INT
	  ,[qrtr]				INT
	  --,[qrtr_yr]			        INT
	  ,[line_code]			        VARCHAR (54)
	  ,[lc_prime]                           VARCHAR (54)
	  ,[class_code]		         	VARCHAR (54)
	  ,[cc_type]                            VARCHAR (54)
	  ,[cc_prime]                           VARCHAR (54)
	  ,[pop_code]                           VARCHAR (54)
	  ,[finance_hierarchy]                  VARCHAR (54)
	  ,[Sep_keycust1]                       VARCHAR (54)
	  ,[Aug_keycust1]                       VARCHAR (54)
	  ,[Jul_keycust1]                       VARCHAR (54)
          ,[keycust1_high_level]                VARCHAR (54)
	  ,[keycust2_top_customer]              VARCHAR (54)
          ,[keycust3_territory]                 VARCHAR (54)
          ,[keycust4]                           VARCHAR (54)
	  ,[sales1]				VARCHAR (54)
	  ,[sales2]				VARCHAR (54)
	  ,[sales3]				VARCHAR (54)
	  ,[sales4]                             VARCHAR (54)
	  ,[active_flag]                        VARCHAR (54)
	  ,[measure]			        VARCHAR (54)
	  ,[measure2]			        VARCHAR (54)
	  ,[qtyord]				FLOAT
	  ,[qtyship]			        FLOAT
	  --,[fill_rate]			FLOAT
	  ,[unit_frcst]			        FLOAT
	  ,[$_frcst]			        FLOAT
	  )
INSERT INTO [summary_pres] (
	   [yr]					
	  ,[mnth]				
	  ,[qrtr]				
	  --,[qrtr_yr]			
	  ,[line_code]			
	  ,[lc_prime]           
	  ,[class_code]			
	  ,[cc_type]            
	  ,[cc_prime]           
	  ,[pop_code]
	  ,[finance_hierarchy]
	  ,[Sep_keycust1]      
	  ,[Aug_keycust1]       
	  ,[Jul_keycust1]       
          ,[keycust1_high_level] 
	  ,[keycust2_top_customer]
          ,[keycust3_territory]
          ,[keycust4]           
	  ,[sales1]				
	  ,[sales2]				
	  ,[sales3]				
	  ,[sales4]
	  ,[active_flag]
	  ,[measure]			
	  ,[measure2]			
	  ,[qtyord]				
	  ,[qtyship]			
	  --,[fill_rate]			
	  ,[unit_frcst]			
	  ,[$_frcst]
	  )
	  
	  ( 
SELECT [yr]					
	  ,[mnth]				
	  ,[qrtr]				
	  --,[qrtr_yr]			
	  ,[line_code]			
	  ,[lc_prime]           
	  ,[class_code]			
	  ,[cc_type]            
	  ,[cc_prime]           
	  ,[pop_code]
	  ,[finance_hierarchy]
	  ,[Sep_keycust1]      
	  ,[Aug_keycust1]       
	  ,[Jul_keycust1]       
          ,[keycust1_high_level] 
	  ,[keycust2_top_customer]
          ,[keycust3_territory]
          ,[keycust4]           
	  ,[sales1]				
	  ,[sales2]				
	  ,[sales3]				
	  ,[sales4]
	  ,[active_flag]
	  ,[measure]			
	  ,[measure2]
	  ,SUM([qtyord])
	  ,SUM([qtyship])
	  --,CASE WHEN ( SUM([qtyord]) = 0) THEN NULL
			--ELSE ( SUM([qtyship]) / SUM([qtyord]) )
			--END
	  ,SUM([unit_frcst_use])
	  ,SUM([$_frcst_use])
  FROM [LOCKED_2020_10_sku_v3_presub]
GROUP BY [yr]					
	  ,[mnth]				
	  ,[qrtr]				
	  --,[qrtr_yr]			
	  ,[line_code]			
	  ,[lc_prime]           
	  ,[class_code]			
	  ,[cc_type]            
	  ,[cc_prime]           
	  ,[pop_code]
	  ,[finance_hierarchy]
	  ,[Sep_keycust1]      
	  ,[Aug_keycust1]       
	  ,[Jul_keycust1]       
          ,[keycust1_high_level] 
	  ,[keycust2_top_customer]
          ,[keycust3_territory]
          ,[keycust4]           
	  ,[sales1]				
	  ,[sales2]				
	  ,[sales3]				
	  ,[sales4]
	  ,[active_flag]
	  ,[measure]			
	  ,[measure2]
	) ; 

INSERT INTO [summary_pres] (
	   [yr]					
	  ,[mnth]				
	  ,[qrtr]				
	  --,[qrtr_yr]			
	  ,[line_code]			
	  ,[lc_prime]           
	  ,[class_code]			
	  ,[cc_type]            
	  ,[cc_prime]           
	  ,[pop_code]			
	  --,[Sep_keycust1]      
	  --,[Aug_keycust1]       
	  --,[Jul_keycust1]       
          ,[keycust1_high_level] 
	  ,[keycust2_top_customer]
          ,[keycust3_territory]
          ,[keycust4]           
	  --,[sales1]				
	  ,[sales2]				
	  ,[sales3]				
	  ,[sales4]
	  ,[measure]			
	  --,[measure2]			
	  ,[qtyord]				
	  ,[qtyship]			
	  --,[fill_rate]			
	  ,[unit_frcst]			
	  ,[$_frcst]
	  )
	  ( 
SELECT [yr]
	  ,[mnth]
	  ,[qrtr]
	  --,[qrtr_yr]
	  ,[line_code]
	  ,[lc_prime]
	  ,[class_code]
	  ,[cc_type]
	  ,[cc_prime]
	  ,[pop_code]
	  --,[finance_hierarchy]
	  --,[Jul_keycust1] 
	  ,[LM_keycust1]
	  ,[keycust1]
	  ,[territory]
	  ,[keycust3]
	  ,[sales1]
	  ,[sales2]
	  ,[sales3]
	  ,'LM frcst'
	  --,'LM frcst'
	  ,SUM([qtyord])
	  ,SUM([qtyship])
	  --,CASE WHEN ( SUM([qtyord]) = 0) THEN NULL
		--	ELSE ( SUM([qtyship]) / SUM([qtyord]) )
			--END
	  ,SUM([unit_frcst])
	  ,SUM([$_frcst])
  FROM [LOCKED_2020_9_summary_EOC FINAL]
  WHERE [yr] IN ('2020', '2021')
    AND [measure] NOT IN ('LM Frcst')
 GROUP BY [yr]
	  ,[mnth]
	  ,[qrtr]
	  --,[qrtr_yr]
	  ,[line_code]
	  ,[lc_prime]
	  ,[class_code]
	  ,[cc_type]
	  ,[cc_prime]
	  ,[pop_code]
	  --,[finance_hierarchy]
	  --,[Jul_keycust1] 
	  ,[LM_keycust1]
	  ,[keycust1]
	  ,[territory]
	  ,[keycust3]
	  ,[sales1]
	  ,[sales2]
	  ,[sales3]
	  ,[measure]			
	  ,[measure2]
	) ; 
   ```
   
   Add columns for data visualization purposes.
   
   ``` 
ALTER TABLE [summary_pres]
	ADD [2017 Actuals] FLOAT

ALTER TABLE [summary_pres]
	ADD [2018 Actuals] FLOAT

ALTER TABLE [summary_pres]
	ADD [2019 Actuals] FLOAT

ALTER TABLE [summary_pres]
	ADD [2020 Actuals] FLOAT

ALTER TABLE [summary_pres]
	ADD [2020 Forecast] FLOAT

ALTER TABLE [summary_pres]
	ADD [2021 Forecast] FLOAT

ALTER TABLE [summary_pres]
	ADD [2017 Actuals U] FLOAT

ALTER TABLE [summary_pres]
	ADD [2018 Actuals U] FLOAT

ALTER TABLE [summary_pres]
	ADD [2019 Actuals U] FLOAT

ALTER TABLE [summary_pres]
	ADD [2020 Actuals U] FLOAT

ALTER TABLE [summary_pres]
	ADD [2020 Forecast U] FLOAT

ALTER TABLE [summary_pres]
	ADD [2021 Forecast U] FLOAT

ALTER TABLE [summary_pres]
	ADD [mnth_alph] VARCHAR(54)
	
ALTER TABLE [summary_pres]
	ADD [quarter] VARCHAR(54)

ALTER TABLE [summary_pres]
	ADD [3] VARCHAR(54)
	
ALTER TABLE [summary_pres]
	ADD [tr3_ord] INT

ALTER TABLE [summary_pres]
	ADD [color_measure] INT
   ```   
   
 Populate the added columns:
 
 ```
UPDATE [summary_pres]
   SET [2017 Actuals] = [$_frcst]
			WHERE [measure2] IN ('2017 Actuals')

UPDATE [summary_pres]
   SET [2018 Actuals] = [$_frcst]
			WHERE [measure2] IN ('2018 Actuals')

UPDATE [summary_pres]
   SET [2019 Actuals] = [$_frcst]
			WHERE [measure2] IN ('2019 Actuals')

UPDATE [summary_pres]
   SET [2020 Actuals] = [$_frcst]
			WHERE [measure2] IN ('2020 Actuals')

UPDATE [summary_pres]
   SET [2020 Forecast] = [$_frcst]
			WHERE [measure2] IN ('2020 Forecast')

UPDATE [summary_pres]
   SET [2021 Forecast] = [$_frcst]
			WHERE [measure2] IN ('2021 Forecast')

UPDATE [summary_pres]
   SET [2017 Actuals U] = [unit_frcst]
			WHERE [measure2] IN ('2017 Actuals')

UPDATE [summary_pres]
   SET [2018 Actuals U] = [unit_frcst]
			WHERE [measure2] IN ('2018 Actuals')

UPDATE [summary_pres]
   SET [2019 Actuals U] = [unit_frcst]
			WHERE [measure2] IN ('2019 Actuals')

UPDATE [summary_pres]
   SET [2020 Actuals U] = [unit_frcst]
			WHERE [measure2] IN ('2020 Actuals')

UPDATE [summary_pres]
   SET [2020 Forecast U] = [unit_frcst]
			WHERE [measure2] IN ('2020 Forecast')

UPDATE [summary_pres]
   SET [2021 Forecast U] = [unit_frcst]
			WHERE [measure2] IN ('2021 Forecast')

UPDATE [summary_pres]
   SET [qrtr] = CASE WHEN [mnth] IN ('1', '2', '3') THEN '1'
					 WHEN [mnth] IN ('4', '5', '6') THEN '2'
					 WHEN [mnth] IN ('7', '8', '9') THEN '3'
					 WHEN [mnth] IN ('10', '11', '12') THEN '4'
					 ELSE NULL END

UPDATE [summary_pres]
   SET [3] = CASE WHEN [mnth] IN ('7', '8','9') THEN ('backward_3')
			 WHEN [mnth] IN ('11', '12', '1') THEN ('forward_3')
			 ELSE NULL END; 

UPDATE [summary_pres]
   SET [mnth_alph] = CASE WHEN [mnth] IN ('1') THEN ('Jan')
			WHEN [mnth] IN ('2') THEN ('Feb')
			WHEN [mnth] IN ('3') THEN ('Mar')
			WHEN [mnth] IN ('4') THEN ('Apr')
			WHEN [mnth] IN ('5') THEN ('May')
			WHEN [mnth] IN ('6') THEN ('Jun')
			WHEN [mnth] IN ('7') THEN ('Jul')
			WHEN [mnth] IN ('8') THEN ('Aug')
			WHEN [mnth] IN ('9') THEN ('Sept')
			WHEN [mnth] IN ('10') THEN ('Oct')
			WHEN [mnth] IN ('11') THEN ('Nov')
			WHEN [mnth] IN ('12') THEN ('Dec')
			ELSE NULL END;
				
UPDATE [summary_pres]
   SET [quarter] = CASE WHEN [qrtr] IN ('1') THEN ('Q1')
			WHEN [qrtr] IN ('2') THEN ('Q2')
			WHEN [qrtr] IN ('3') THEN ('Q3')
			WHEN [qrtr] IN ('4') THEN ('Q4')
			ELSE NULL END;
		
UPDATE [summary_pres]
   SET [tr3_ord] = CASE WHEN [3] IN ('backward_3') THEN ('1')
			WHEN [3] IN ('forward_3') THEN ('2')
			ELSE NULL END;	
/*
UPDATE [summary_pres]
	SET [color_measure] = CASE WHEN [measure] IN ('actuals') THEN 0
				   WHEN [measure] IN ('forecast') THEN 1
				   WHEN [measure] IN ('LM Forecast') AND [yr] IN ('2020') AND [yr] IN ('1', '2', '3', '4', '5', '6', '7', '8', '9') THEN 1
				   WHEN [measure] IN ('LM Forecast') AND [yr] IN ('2020') AND [yr] IN (''10', '11', '12') THEN 2
				   WHEN [measure] IN ('LM Forecast') AND [yr] IN ('2021') THEN 2
				   ELSE NULL END;	
							   */

UPDATE  [summary_pres]
	SET [measure2] = ('2020 LM Frcst')
	                  WHERE [measure] = 'LM Frcst' AND [yr] = '2020'

UPDATE  [summary_pres]
	SET [measure2] = ('2021 LM Frcst')
	                  WHERE [measure] = 'LM Frcst' AND [yr] = '2021'


UPDATE [summary_pres]
  SET [measure2] = '2020 act/frcst' 
                    WHERE [measure] IN ('forecast', 'actuals') 
		     AND [yr] IN ('2020')  ;

UPDATE [summary_pres]
	SET [color_measure] = CASE WHEN [measure2] IN ('2017 actuals', '2018 actuals', '2019 actuals') THEN 0
			           WHEN [measure2] IN ('2020 act/frcst') AND [mnth] IN ('1', '2', '3', '4', '5', '6', '7', '8', '9') THEN 0
				   WHEN [measure2] IN ('2020 act/frcst') AND [mnth] IN ('10', '11', '12') THEN 1
				   WHEN [measure2] IN ('2021 forecast') THEN 1
				   WHEN [measure2] IN ('2020 LM Frcst') AND [yr] IN ('2020') AND [mnth] IN ('1', '2', '3', '4', '5', '6', '7', '8') THEN 0
				   WHEN [measure2] IN ('2020 LM Frcst') AND [yr] IN ('2020') AND [mnth] IN ('9', '10', '11', '12') THEN 2
				   WHEN [measure2] IN ('2021 LM Frcst') AND [yr] IN ('2021') THEN 2
				   ELSE NULL END;
	 				 
UPDATE [summary_pres]
	SET [lc_prime] = CASE WHEN [line_code] IN ('DRR', 'FRC', 'CAL', 'SAS') 
	                      THEN 'prime'
			      ELSE 'not prime' END;

UPDATE [summary_pres]
   SET [keycust2_top_customer] = 'Performance'
				  WHERE [keycust2_top_customer] IN ('Stoptech');

UPDATE [summary_pres]
   SET [keycust1_high_level] = 'Performance'
			        WHERE [keycust1_high_level] IN ('Stoptech');

UPDATE [summary_pres]
  SET [keycust2_top_customer] = 'All Other' 
				WHERE [keycust2_top_customer] IN ('Heavy Duty');



UPDATE [summary_pres]
  SET [measure2] = '2020 LM frcst' 
                    WHERE [measure] IN ('LM Frcst') 
		      AND [yr] IN ('2020')  ;


UPDATE [summary_pres]
  SET [measure2] = '2021 LM frcst' 
                    WHERE [measure] IN ('LM Frcst')  
		     AND [yr] IN ('2021')  ;



UPDATE [summary_pres]
  SET [keycust2_top_customer] = 'All Other' 
				WHERE [keycust2_top_customer] IS NULL

```
Best practices suggest that we do not forecast the current month. So we delete the current month's forecast and replace it with last month.

```
DELETE FROM [summary_pres]
 WHERE [yr] IN ('2020')
   AND [mnth] IN ('10')
   AND [measure] IN ('forecast');
   
 INSERT INTO [summary_pres] (
	[yr]
	,[mnth]
	,[qrtr]
	,[line_code]
	,[lc_prime]
	,[class_code]
	,[cc_type]
	,[cc_prime]
	,[pop_code]
	,[Jul_keycust1]       
        ,[keycust1_high_level] 
	,[keycust2_top_customer]
        ,[keycust3_territory]
        ,[keycust4]     
	,[sales1]
	,[sales2]
	,[sales3]
	,[measure]
	,[measure2]
	--[qtyord],
	--[qtyship],
	--[fill_rate],
	,[unit_frcst]
	,[$_frcst]
	,[2017 Actuals]
	,[2018 Actuals]
	,[2019 Actuals]
	,[2020 Actuals]
	,[2020 Forecast]
	,[2021 Forecast]
	,[2017 Actuals U]
	,[2018 Actuals U]
	,[2019 Actuals U]
	,[2020 Actuals U]
	,[2020 Forecast U]
	,[2021 Forecast U]
	,[mnth_alph]
	,[quarter]
	,[3]
	,[tr3_ord]
	,[color_measure]
	)
SELECT 	[yr],
	[mnth],
	[qrtr],
	[line_code],
	[lc_prime],
	[class_code],
	[cc_type],
	[cc_prime],
	[pop_code],
	[finance_hierarchy],
	[high level],
	[keycust1],
	[territory],
	[keycust3],
	[sales1],
	[sales2],
	[sales3],
	[measure],
	[measure2],
	--[qtyord],
	--[qtyship],
	--[fill_rate],
	[unit_frcst],
	[$_frcst],
	[2017 Actuals],
	[2018 Actuals],
	[2019 Actuals],
	[2020 Actuals],
	[2020 Forecast],
	[2021 Forecast],
	[2017 Actuals U],
	[2018 Actuals U],
	[2019 Actuals U],
	[2020 Actuals U],
	[2020 Forecast U],
	[2021 Forecast U],
	[mnth_alph],
	[quarter],
	[3],
	[tr3_ord],
	[color_measure]
FROM [LOCKED_2020_9_summary_EOC FINAL]
 WHERE [yr] IN ('2020')
   AND [mnth] IN ('10')
   AND [measure] IN ('forecast');

 ```
 
 We then clean up all the data to ensure there are minimal discrepancies between this month's metadata and last.
 
 ```
 UPDATE [summary_pres]
  SET [keycust2_top_customer] = CASE WHEN [keycust2_top_customer] IN ('A & Jay Automotive Warehouse') THEN ('A & Jay')
                                     WHEN [keycust2_top_customer] LIKE 'Nolt%' THEN 'Nolts'
				     WHEN [keycust2_top_customer] LIKE 'Parts Plus N%' THEN 'Parts Plus NM'
                                     ELSE [keycust2_top_customer] END;
UPDATE [summary_pres]
  SET [measure2] = '2020 act/frcst' 
                    WHERE [measure] IN ('forecast', 'actuals') 
		      AND [yr] IN ('2020')  ; 

UPDATE [summary_pres]
  SET [keycust1_high_level] = CASE WHEN [keycust1_high_level] LIKE 'A & Jay%' THEN 'All Other'
                                   WHEN [keycust1_high_level] LIKE 'ACI%' THEN 'All Other'
			           WHEN [keycust1_high_level] LIKE 'All Other%' THEN 'All Other'
                                   WHEN [keycust1_high_level] LIKE 'APW%' THEN 'All Other'
			           WHEN [keycust1_high_level] LIKE 'Automotive Brake%' THEN 'All Other'
                                   WHEN [keycust1_high_level] LIKE 'Automotive Hard Parts%' THEN 'All Other'
			           WHEN [keycust1_high_level] LIKE 'Bendix Spicer%' THEN 'All Other'
                                   WHEN [keycust1_high_level] LIKE 'Certified Undercar%' THEN 'All Other'
			           WHEN [keycust1_high_level] LIKE 'Cost Less%' THEN 'All Other'
				   WHEN [keycust1_high_level] LIKE 'Eastern%' THEN 'All Other'
				   WHEN [keycust1_high_level] LIKE 'IWI%' THEN 'All Other'
				   WHEN [keycust1_high_level] LIKE 'FMP%' THEN 'FMP'
                                   WHEN [keycust1_high_level] LIKE 'Levine%' THEN 'All Other'
                                   WHEN [keycust1_high_level] LIKE 'Lordco%' THEN 'Canada'
				   WHEN [keycust1_high_level] LIKE 'Monroe%' THEN 'All Other'
				   WHEN [keycust1_high_level] LIKE 'NAPA%' THEN 'Canada'
				   WHEN [keycust1_high_level] = 'na' THEN 'All Other'
				   WHEN [keycust1_high_level] LIKE 'Neptune%' THEN 'All Other'
                                   WHEN [keycust1_high_level] LIKE 'Nolt%' THEN 'All Other'
				   WHEN [keycust1_high_level] LIKE 'NPW%' THEN 'All Other'
				   WHEN [keycust1_high_level] LIKE 'Olympic Brake%' THEN 'All Other'
				   WHEN [keycust1_high_level] LIKE 'Olympus%' THEN 'All Other'
				   WHEN [keycust1_high_level] LIKE 'One Stop%' THEN 'All Other'
				   WHEN [keycust1_high_level] LIKE 'Parts Authority%' THEN 'Parts Authority' 
				   WHEN [keycust1_high_level] LIKE 'Parts House%'  THEN 'All Other'
				   WHEN [keycust1_high_level] LIKE 'Parts Plus N%' THEN 'All Other'
				   WHEN [keycust1_high_level] LIKE 'Piston Ring%' THEN 'Canada'
				   WHEN [keycust1_high_level] LIKE 'Prostock%' THEN 'All Other'
				   WHEN [keycust1_high_level] LIKE 'Piston Ring%' THEN 'Canada'
				   WHEN [keycust1_high_level] LIKE 'Retail%' THEN 'All Other'
				   WHEN [keycust1_high_level] LIKE 'Standard%' THEN 'All Other'
				   WHEN [keycust1_high_level] LIKE 'Stoptech%' THEN 'Performance'
				   WHEN [keycust1_high_level] LIKE 'TBD%' THEN 'All Other'
				   WHEN [keycust1_high_level] LIKE 'VI%' THEN 'All Other'
				   WHEN [keycust1_high_level] LIKE 'Undercar Plus%' THEN 'All Other'
				   WHEN [keycust1_high_level] LIKE 'Warren%' THEN 'All Other'
                                   WHEN [keycust1_high_level] LIKE 'Worldpac%' THEN 'All Other'
				   WHEN [keycust1_high_level] LIKE 'Wheeler' THEN 'All Other'
                                   ELSE [keycust1_high_level] END

UPDATE [summary_pres]
  SET [keycust1_high_level] = CASE WHEN [keycust2_top_customer] IN ('Piston Ring Services', 'Lordco') THEN 'Canada'
                                   WHEN [keycust2_top_customer] IN ('United Auto Supply') THEN 'United Auto Supply'
                                   WHEN [keycust2_top_customer] IN ('Fast Undercar') THEN 'Fast Undercar'
                                   WHEN [keycust2_top_customer] IN ('FMP') THEN 'FMP'
                                   WHEN [keycust2_top_customer] IN ('Parts Authority') THEN 'Parts Authority'
                                   WHEN [keycust2_top_customer] IN ('Smyth') THEN 'Smyth'
                                   WHEN [keycust2_top_customer] IN ('XL Parts') THEN 'XL Parts'
								   ELSE [keycust1_high_level] END;

UPDATE [summary_pres]
  SET [keycust2_top_customer] = CASE WHEN [keycust2_top_customer] LIKE 'A & Jay%' THEN 'All Other'
                        WHEN [keycust2_top_customer] LIKE 'ACI%' THEN 'ACI'
						WHEN [keycust2_top_customer] LIKE 'All Other%' THEN 'All Other'
                        WHEN [keycust2_top_customer] LIKE 'APW%' THEN 'All Other'
						WHEN [keycust2_top_customer] LIKE 'Automotive Brake%' THEN 'All Other'
                        WHEN [keycust2_top_customer] LIKE 'Automotive Hard Parts%' THEN 'All Other'
						WHEN [keycust2_top_customer] LIKE 'Bendix Spicer%' THEN 'Bendix Spicer'
                        WHEN [keycust2_top_customer] LIKE 'Certified Undercar%' THEN 'Certified Undercar'
						WHEN [keycust2_top_customer] LIKE 'Cost Less%' THEN 'Cost Less Auto Parts'
						WHEN [keycust2_top_customer] LIKE 'FMP%' THEN 'FMP'
                        WHEN [keycust2_top_customer] LIKE 'Levine%' THEN 'Levine'
                        WHEN [keycust2_top_customer] LIKE 'Lordco%' THEN 'Lordco'
						WHEN [keycust2_top_customer] LIKE 'Monroe%' THEN 'Monroe'
						WHEN [keycust2_top_customer] LIKE 'NAPA%' THEN 'NAPA'
						WHEN [keycust2_top_customer] LIKE 'Neptune%' THEN 'Neptune'
                        WHEN [keycust2_top_customer] LIKE 'Nolt%' THEN 'Nolts'
						WHEN [keycust2_top_customer] LIKE 'NPW%' THEN 'NPW'
						WHEN [keycust2_top_customer] LIKE 'Olympic Brake%' THEN 'Olympic Brake'
						WHEN [keycust2_top_customer] LIKE 'Olympus%' THEN 'Olympus'
						WHEN [keycust2_top_customer] LIKE 'One Stop%' THEN 'One Stop'
						WHEN [keycust2_top_customer] LIKE 'Parts Authority%' THEN 'Parts Authority' 
						WHEN [keycust2_top_customer] LIKE 'Parts Plus N%' THEN 'Parts Plus NM'
						WHEN [keycust2_top_customer] LIKE 'Prostock%' THEN 'Prostock'
						WHEN [keycust2_top_customer] LIKE 'Standard%' THEN 'Standard'
						WHEN [keycust2_top_customer] LIKE 'Undercar Plus%' THEN 'Undercar Plus'
						WHEN [keycust2_top_customer] LIKE 'Warren%' THEN 'All Other'
                        WHEN [keycust2_top_customer] LIKE 'Worldpac%' THEN 'Worldpac'
						WHEN [keycust2_top_customer] LIKE 'Wheeler' THEN 'Wheeler'

                        ELSE [keycust2_top_customer] END

UPDATE [summary_pres]
  SET [keycust2_top_customer] = 'All Other' 
                                 WHERE [keycust2_top_customer] IS NULL;

UPDATE [summary_pres]
  SET [keycust4] = CASE WHEN [keycust4] LIKE 'A & Jay%' THEN 'All Other'
                        WHEN [keycust4] LIKE 'ACI%' THEN 'ACI'
                        WHEN [keycust4] LIKE 'APW%' THEN 'All Other'
						--WHEN [keycust4] LIKE 'All Other%' THEN 'All Other'
						WHEN [keycust4] LIKE 'Automotive Brake%' THEN 'All Other'
						WHEN [keycust4] LIKE 'Automotive Hard Parts%' THEN 'All Other'
						WHEN [keycust4] LIKE 'Bendix Spicer%' THEN 'Bendix Spicer'
						WHEN [keycust4] LIKE 'Cost Less%' THEN 'Cost Less Auto Parts'
                        WHEN [keycust4] LIKE 'Levine%' THEN 'Levine'
						WHEN [keycust4] LIKE 'Monroe%' THEN 'Monroe'
						WHEN [keycust4] LIKE 'Neptune%' THEN 'Neptune'
                        WHEN [keycust4] LIKE 'Nolt%' THEN 'Nolts'
						WHEN [keycust4] LIKE 'One Stop%' THEN 'One Stop'
						WHEN [keycust4] LIKE 'Parts Plus N%' THEN 'Parts Plus NM'
						WHEN [keycust4] LIKE 'Prostock%' THEN 'Prostock'
						WHEN [keycust4] LIKE 'Standard%' THEN 'Standard'
						WHEN [keycust4] LIKE 'Warren%' THEN 'All Other - Socal'
						WHEN [keycust4] LIKE 'Wheeler%' THEN 'Wheeler'
                        ELSE [keycust4] END
/*
UPDATE [summary_pres]
  SET [finance_hierarchy] =  CASE WHEN [finance_hierarchy] LIKE 'A & Jay%' THEN 'A & Jay'
                        WHEN [finance_hierarchy] LIKE 'APW%' THEN 'APW'
						WHEN [finance_hierarchy] LIKE 'ACI%' THEN 'All Other'
                        WHEN [finance_hierarchy] LIKE 'All Other%' THEN 'All Other'
						WHEN [finance_hierarchy] LIKE 'Automotive Brake%' THEN 'Automotive Brake'
						WHEN [finance_hierarchy] LIKE 'Bendix Spicer%' THEN 'Bendix Spicer'
						WHEN [finance_hierarchy] LIKE 'Cost Less%' THEN 'Cost Less Auto Parts'
                        WHEN [finance_hierarchy] LIKE 'Levine%' THEN 'Levine'
						WHEN [finance_hierarchy] LIKE 'Monroe%' THEN 'Monroe'
						WHEN [finance_hierarchy] LIKE 'Neptune%' THEN 'Neptune'
                        WHEN [finance_hierarchy] LIKE 'Nolt%' THEN 'Nolts'
						WHEN [finance_hierarchy] LIKE 'Parts Plus N' THEN 'Parts Plus NM'
						WHEN [finance_hierarchy] LIKE 'Prostock' THEN 'Prostock'
						WHEN [finance_hierarchy] LIKE 'Standard' THEN 'Standard'
						WHEN [finance_hierarchy] LIKE 'Wheeler' THEN 'Wheeler'
						WHEN [finance_hierarchy] LIKE 'Wheeler' THEN 'Wheeler'
                        ELSE [finance_hierarchy] END
						*/
--UPDATE [summary_pres]
  --SET [keycust2_top_customer] =  'All Other'
    --                 WHERE [keycust2_top_customer] LIKE 'All Other %'


UPDATE [summary_pres]
  SET [keycust2_top_customer] =  'All Other'
                     WHERE [keycust2_top_customer] = 'mexico - all other'

UPDATE [summary_pres]
  SET [keycust4] =  'All Other - Hawaii'
                     WHERE [keycust4] = 'hawaii all other'

UPDATE [summary_pres]
  SET [keycust2_top_customer] =  'All Other'
                     WHERE [keycust2_top_customer] = 'hawaii all other'


UPDATE [summary_pres]
  SET [keycust2_top_customer] =  'Fast Undercar'
                     WHERE [keycust2_top_customer] LIKE 'fast under%'
/*
UPDATE [summary_pres]
  SET [finance_hierarchy] =  'Parts Authority'
                     WHERE [keycust4] IN ('Parts Authority - SoCal')
*/
UPDATE [summary_pres]
   SET [3] = CASE WHEN [mnth] IN ('6', '7', '8') THEN ('backward_3')
				  WHEN [mnth] IN ('10', '11', '12') THEN ('forward_3')
				  ELSE NULL END;

UPDATE [summary_pres]
   SET [keycust1_high_level] = 'All Other'
                      WHERE [keycust1_high_level] IS NULL;

UPDATE [summary_pres]
   SET [keycust1_high_level] = 'All Other'
                      WHERE [keycust1_high_level] LIKE 'A & J%';

UPDATE [summary_pres]
   SET [keycust2_top_customer] = 'US Auto Force'
                      WHERE [keycust4] LIKE 'US Auto Force%';

UPDATE [summary_pres]
   SET [keycust1_high_level] = 'US Auto Force'
                      WHERE [keycust4] LIKE 'US Auto Force%';
